# 第21题详细解答：多语言扩展（新增语言的完整流程）

> 题干：新增一种语言的完整流程是怎样的？（考察点：扩展性、流程规范、质量保证）

## 面试者视角（怎么答）

### 1) 立项与准备
- 评估：目标国家/地区、脚本/书写方向（LTR/RTL）、法规（隐私/文案）、客服与支持。
- 配置：在配置中心登记语言代码（如 `pt-BR`）、回退链、默认字体与日期/货币格式。

### 2) 资产与工程
- 创建目录：`locales/pt-BR/{common,feature,...}.ts`；拷贝 `en` 为基准。
- 翻译：批量脚本增量提取 + MT + 术语表 + 人工校对；图片/图标含文本需准备本地化替代。
- 字体与排版：准备该语言脚本的字体子集与回退链；RTL 切换（如阿语）。

### 3) 接入与测试
- 动态加载：在 `i18n` 注册语言并允许切换；首屏根据浏览器或用户设置自动选择。
- 测试矩阵：文案膨胀/截断、日期/货币、输入法（IME）、RTL、弱网。
- 指标看板：新增语言的 LCP/错误率/转化，问题快速回归。

### 4) 发布与回滚
- 灰度：小流量灰度 + 域/国家定向；问题发现快速回滚到回退语言。
- 维护：后续翻译增量自动加入；术语与禁用词库更新。

### 5) 小结（30s）
- “新增语言按准备→翻译→工程接入→测试→灰度发布流程推进，保障字体/RTL/格式与质量闭环，并在指标看板上持续跟踪。”

---

## 面试官视角（怎么问、看什么）

### 可追问清单（附考点）
- 语言代码与地区？
  - 考点：`pt` vs `pt-BR`、回退链、货币/日期格式差异。
- 翻译质量控制？
  - 考点：术语/禁用词、占位校验、人工校对流程、图片本地化。
- 字体/RTL？
  - 考点：子集化、回退链、逻辑属性、混排边界。
- 灰度与回滚？
  - 考点：按国家发布、快速回滚机制、指标监控。

### 评估要点
- 是否覆盖资产/工程/测试/发布；是否有质量与回滚机制。

### 红旗信号
- 仅翻译文本；忽略字体/RTL/格式；无灰度与监控。

---

## 代码与配置片段
```ts
// i18n 注册（示意）
const supported = ['en','zh','ja','pt-BR']
```
```json
// 语言清单（配置中心）
{ "default": "en", "fallbacks": { "pt-BR": ["pt","en"] } }
```

---

## 实战建议
- 把新增语言做成流水线任务；翻译、图片与字体打通；建立回归清单与截图对比。

## 常见坑
- 仅做 `pt` 忽略 `pt-BR/pt-PT` 差异；RTL 方向性错误；占位破坏。

## 总结
- 新增语言的关键是“资产齐备 + 工程接入 + 质量闭环 + 灰度与指标”。
