# HTTP å’Œ SSL åè®®è¯¦è§£

## è€ƒç‚¹æ¦‚è¿°
ç†è§£HTTPå’ŒSSLåè®®æ˜¯å‰ç«¯å¼€å‘çš„åŸºç¡€ï¼Œæ¶‰åŠç½‘ç»œè¯·æ±‚çš„å®‰å…¨æ€§ã€æ€§èƒ½å’Œé€šä¿¡åŽŸç†ã€‚

---

## HTTP åè®®è¯¦è§£

### 1. HTTP åŸºç¡€æ¦‚å¿µ
**è€ƒç‚¹ï¼š** è¯·æ±‚/å“åº”æ¨¡åž‹ã€æ— çŠ¶æ€ç‰¹æ€§ã€æ–¹æ³•ã€çŠ¶æ€ç 

**é€šä¿—è§£é‡Šï¼š**
HTTPå°±åƒ"é‚®ä»¶ç³»ç»Ÿ"ï¼š
- æµè§ˆå™¨å‘é€è¯·æ±‚ä¿¡ä»¶ç»™æœåŠ¡å™¨
- æœåŠ¡å™¨å¤„ç†åŽå›žå¤å“åº”ä¿¡ä»¶
- ä¸€æ¬¡è¯·æ±‚-å“åº”å®Œæˆï¼Œä¸¤è¾¹å°±äº’ç›¸"å¿˜è®°"äº†ï¼ˆæ— çŠ¶æ€ï¼‰

**åŽŸç†ï¼š**
```
HTTPè¯·æ±‚æ ¼å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯·æ±‚è¡Œï¼šGET /api/user HTTP/1.1      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¯·æ±‚å¤´ï¼š                            â”‚
â”‚ Host: example.com                  â”‚
â”‚ Content-Type: application/json      â”‚
â”‚ Authorization: Bearer token123      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç©ºè¡Œ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¯·æ±‚ä½“ï¼ˆå¯é€‰ï¼‰ï¼š                     â”‚
â”‚ {"username": "alice", "age": 25}   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

HTTPå“åº”æ ¼å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ çŠ¶æ€è¡Œï¼šHTTP/1.1 200 OK             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å“åº”å¤´ï¼š                            â”‚
â”‚ Content-Type: application/json      â”‚
â”‚ Content-Length: 128                 â”‚
â”‚ Set-Cookie: sessionId=abc123        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç©ºè¡Œ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å“åº”ä½“ï¼š                            â”‚
â”‚ {"id": 1, "name": "alice", ...}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. HTTP æ–¹æ³•
**è€ƒç‚¹ï¼š** GETã€POSTã€PUTã€DELETEã€PATCHçš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯

**é€šä¿—è§£é‡Šï¼š**
å°±åƒåŽ»ä¹¦åº—ï¼š
- **GET** - çœ‹ä¹¦ï¼ˆèŽ·å–æ•°æ®ï¼Œä¸ä¿®æ”¹ï¼‰
- **POST** - æ–°å¢žä¹¦ï¼ˆåˆ›å»ºæ–°æ•°æ®ï¼‰
- **PUT** - æ›¿æ¢æ•´æœ¬ä¹¦ï¼ˆå®Œå…¨æ›¿æ¢æ•°æ®ï¼‰
- **DELETE** - æ‰”æŽ‰è¿™æœ¬ä¹¦ï¼ˆåˆ é™¤æ•°æ®ï¼‰
- **PATCH** - ä¿®æ­£ä¸€é¡µï¼ˆéƒ¨åˆ†ä¿®æ”¹æ•°æ®ï¼‰

**åŽŸç†ä¸Žå®žæˆ˜ï¼š**
```javascript
// GET - å®‰å…¨ã€å¹‚ç­‰ã€æ— è¯·æ±‚ä½“
fetch('/api/users')
  .then(res => res.json())
  .then(data => console.log(data))

// POST - åˆ›å»ºèµ„æº
fetch('/api/users', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ name: 'Bob', email: 'bob@example.com' })
})

// PUT - å®Œå…¨æ›¿æ¢ï¼ˆéœ€è¦æä¾›å®Œæ•´æ•°æ®ï¼‰
fetch('/api/users/1', {
  method: 'PUT',
  body: JSON.stringify({
    name: 'Bob Updated',
    email: 'bob.new@example.com',
    age: 30,
    // å…¶ä»–æ‰€æœ‰å­—æ®µéƒ½éœ€è¦æä¾›
  })
})

// PATCH - éƒ¨åˆ†ä¿®æ”¹ï¼ˆåªæä¾›è¦æ”¹çš„å­—æ®µï¼‰
fetch('/api/users/1', {
  method: 'PATCH',
  body: JSON.stringify({ email: 'bob.new@example.com' })
  // åªä¿®æ”¹emailï¼Œå…¶ä»–å­—æ®µä¿æŒä¸å˜
})

// DELETE - åˆ é™¤èµ„æº
fetch('/api/users/1', { method: 'DELETE' })
```

**æ ¸å¿ƒç‰¹æ€§å¯¹æ¯”ï¼š**
| æ–¹æ³• | å®‰å…¨ | å¹‚ç­‰ | æœ‰è¯·æ±‚ä½“ | åº”ç”¨åœºæ™¯ |
|-----|------|------|---------|---------|
| GET | âœ… | âœ… | âŒ | èŽ·å–æ•°æ® |
| POST | âŒ | âŒ | âœ… | åˆ›å»ºæ•°æ® |
| PUT | âŒ | âœ… | âœ… | å®Œå…¨æ›´æ–° |
| PATCH | âŒ | âŒ | âœ… | éƒ¨åˆ†æ›´æ–° |
| DELETE | âŒ | âœ… | âŒ | åˆ é™¤æ•°æ® |

**å®‰å…¨**ï¼šæ“ä½œä¸æ”¹å˜æœåŠ¡å™¨æ•°æ®
**å¹‚ç­‰**ï¼šç›¸åŒæ“ä½œå¤šæ¬¡å’Œä¸€æ¬¡ç»“æžœä¸€æ ·

---

### 3. HTTP çŠ¶æ€ç 
**è€ƒç‚¹ï¼š** å¸¸è§çŠ¶æ€ç çš„å«ä¹‰å’Œå¤„ç†æ–¹å¼

**é€šä¿—è§£é‡Šï¼š**
æœåŠ¡å™¨çš„"å›žå¤ä»£ç "ï¼Œå‘Šè¯‰ä½ è¯·æ±‚çš„ç»“æžœï¼š
- **1xx** - ä¿¡æ¯ç±»ï¼ˆå¤„ç†ä¸­ï¼‰
- **2xx** - æˆåŠŸç±»ï¼ˆæˆåŠŸäº†ï¼‰
- **3xx** - é‡å®šå‘ç±»ï¼ˆçœ‹åˆ«å¤„ï¼‰
- **4xx** - å®¢æˆ·ç«¯é”™è¯¯ï¼ˆä½ çš„é—®é¢˜ï¼‰
- **5xx** - æœåŠ¡å™¨é”™è¯¯ï¼ˆæˆ‘çš„é—®é¢˜ï¼‰

**å¸¸è§çŠ¶æ€ç è¯¦è§£ï¼š**
```javascript
// 2xx - æˆåŠŸ
200 OK - è¯·æ±‚æˆåŠŸ
201 Created - åˆ›å»ºæˆåŠŸï¼ˆç”¨äºŽPOSTï¼‰
204 No Content - æˆåŠŸä½†æ— è¿”å›žå†…å®¹ï¼ˆç”¨äºŽDELETEï¼‰

// 3xx - é‡å®šå‘
301 Moved Permanently - æ°¸ä¹…é‡å®šå‘
302 Found - ä¸´æ—¶é‡å®šå‘
304 Not Modified - èµ„æºæœªä¿®æ”¹ï¼ˆç¼“å­˜ç›¸å…³ï¼‰

// 4xx - å®¢æˆ·ç«¯é”™è¯¯
400 Bad Request - è¯·æ±‚å‚æ•°é”™è¯¯
401 Unauthorized - éœ€è¦è®¤è¯ï¼ˆç™»å½•ï¼‰
403 Forbidden - ç¦æ­¢è®¿é—®ï¼ˆæ²¡æƒé™ï¼‰
404 Not Found - èµ„æºä¸å­˜åœ¨
429 Too Many Requests - è¯·æ±‚è¿‡äºŽé¢‘ç¹

// 5xx - æœåŠ¡å™¨é”™è¯¯
500 Internal Server Error - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
502 Bad Gateway - ç½‘å…³é”™è¯¯
503 Service Unavailable - æœåŠ¡ä¸å¯ç”¨
```

**å®žæˆ˜å¤„ç†ï¼š**
```javascript
async function handleResponse(response) {
  if (response.status === 200) {
    return response.json()
  } else if (response.status === 401) {
    // éœ€è¦é‡æ–°ç™»å½•
    window.location.href = '/login'
  } else if (response.status === 403) {
    // æ²¡æœ‰æƒé™
    throw new Error('You do not have permission')
  } else if (response.status === 404) {
    throw new Error('Resource not found')
  } else if (response.status >= 500) {
    // æœåŠ¡å™¨é”™è¯¯ï¼Œå¯èƒ½éœ€è¦é‡è¯•
    throw new Error('Server error, please retry later')
  }
}
```

---

### 4. HTTP ç‰ˆæœ¬æ¼”è¿›
**è€ƒç‚¹ï¼š** HTTP/1.0ã€HTTP/1.1ã€HTTP/2ã€HTTP/3çš„åŒºåˆ«

**é€šä¿—è§£é‡Šï¼š**
```
HTTP/1.0 (1996)
â”œâ”€ æ¯æ¬¡è¯·æ±‚å»ºç«‹æ–°è¿žæŽ¥ï¼ˆå»ºç«‹è¿žæŽ¥æ…¢ï¼‰
â”œâ”€ ä¸æ”¯æŒæŒä¹…è¿žæŽ¥
â””â”€ æ•ˆçŽ‡ä½Ž

HTTP/1.1 (1997) â­ ä¸»æµ
â”œâ”€ æŒä¹…è¿žæŽ¥ï¼šConnection: keep-aliveï¼ˆå¤ç”¨TCPè¿žæŽ¥ï¼‰
â”œâ”€ ç®¡é“åŒ–ï¼šå¯å‘é€å¤šä¸ªè¯·æ±‚ï¼ˆä½†å“åº”å¿…é¡»æœ‰åºï¼‰
â”œâ”€ ç¼“å­˜æœºåˆ¶ï¼šETagã€Last-Modifiedç­‰
â””â”€ è™šæ‹Ÿä¸»æœºæ”¯æŒ

HTTP/2 (2015) ðŸš€ çŽ°ä»£
â”œâ”€ å¤šè·¯å¤ç”¨ï¼šåœ¨ä¸€ä¸ªè¿žæŽ¥ä¸Šå¹¶è¡Œä¼ è¾“å¤šä¸ªè¯·æ±‚/å“åº”
â”œâ”€ äºŒè¿›åˆ¶åˆ†å¸§ï¼šä¸å†æ˜¯æ–‡æœ¬ï¼Œè€Œæ˜¯äºŒè¿›åˆ¶å¸§ï¼ˆæ›´é«˜æ•ˆï¼‰
â”œâ”€ æœåŠ¡å™¨æŽ¨é€ï¼šä¸»åŠ¨å‘é€èµ„æºç»™å®¢æˆ·ç«¯
â”œâ”€ å¤´éƒ¨åŽ‹ç¼©ï¼šä½¿ç”¨HPACKç®—æ³•åŽ‹ç¼©å¤´éƒ¨
â””â”€ æ€§èƒ½æå‡3å€

HTTP/3 (2022) âš¡
â”œâ”€ åŸºäºŽQUICåè®®ï¼ˆUDPè€ŒéžTCPï¼‰
â”œâ”€ æ›´å¿«çš„è¿žæŽ¥å»ºç«‹
â”œâ”€ æ›´å¥½çš„ä¸¢åŒ…æ¢å¤
â””â”€ ç§»åŠ¨ç½‘ç»œå‹å¥½
```

**åœ¨å‰ç«¯ä¸­çš„ä½“çŽ°ï¼š**
```javascript
// HTTP/1.1 æ—¶ä»£çš„ä¼˜åŒ–ç­–ç•¥
// - åˆå¹¶CSS/JSï¼ˆå‡å°‘è¯·æ±‚æ•°ï¼‰
// - å†…è”å°å›¾ç‰‡ï¼ˆå‡å°‘è¯·æ±‚æ•°ï¼‰
// - åŸŸååˆ†ç‰‡ï¼ˆç»•è¿‡æµè§ˆå™¨å¹¶å‘é™åˆ¶ï¼‰

// HTTP/2 æ—¶ä»£çš„ä¼˜åŒ–ç­–ç•¥ï¼ˆè¿™äº›ç­–ç•¥åè€Œæœ‰å®³ï¼ï¼‰
// âŒ ä¸å†éœ€è¦åˆå¹¶æ–‡ä»¶
// âŒ ä¸éœ€è¦å†…è”
// âœ… å¯ä»¥åˆ†æ•£èµ„æºï¼Œè®©æµè§ˆå™¨å¹¶è¡ŒåŠ è½½
```

---

## HTTPS å’Œ SSL/TLS è¯¦è§£

### 1. HTTPS çš„å¿…è¦æ€§
**è€ƒç‚¹ï¼š** HTTPçš„å®‰å…¨é—®é¢˜ã€HTTPSçš„ä¼˜åŠ¿

**é€šä¿—è§£é‡Šï¼š**
- **HTTP** - åƒæ˜Žä¿¡ç‰‡ï¼šä»»ä½•äººéƒ½èƒ½çœ‹åˆ°å†…å®¹
- **HTTPS** - åƒåŠ å¯†ä¿¡ä»¶ï¼šå†…å®¹è¢«åŠ å¯†ï¼Œåªæœ‰æ”¶ä»¶äººèƒ½çœ‹

**HTTPçš„ä¸‰å¤§é—®é¢˜ï¼š**
```
1. çªƒå¬é£Žé™©ï¼ˆEavesdroppingï¼‰
   â”œâ”€ æ”»å‡»è€…å¯ä»¥æˆªèŽ·ç½‘ç»œåŒ…
   â””â”€ çœ‹åˆ°æ‰€æœ‰é€šä¿¡å†…å®¹ï¼ˆå¯†ç ã€éšç§æ•°æ®ç­‰ï¼‰

2. ç¯¡æ”¹é£Žé™©ï¼ˆTamperingï¼‰
   â”œâ”€ æ”»å‡»è€…å¯ä»¥ä¿®æ”¹ç½‘ç»œåŒ…å†…å®¹
   â””â”€ è®©ç”¨æˆ·æ”¶åˆ°ä¼ªé€ çš„æ•°æ®

3. å†’å……é£Žé™©ï¼ˆImpersonationï¼‰
   â”œâ”€ æ”»å‡»è€…å¯ä»¥å‡è£…æ˜¯æœåŠ¡å™¨
   â””â”€ ç”¨æˆ·æ— æ³•ç¡®è®¤æ˜¯å¦åœ¨å’ŒçœŸå®žæœåŠ¡å™¨é€šä¿¡
```

---

### 2. SSL/TLS åŠ å¯†åŽŸç†
**è€ƒç‚¹ï¼š** å¯¹ç§°åŠ å¯†ã€éžå¯¹ç§°åŠ å¯†ã€è¯ä¹¦ã€æ¡æ‰‹è¿‡ç¨‹

**é€šä¿—è§£é‡Šï¼š**
```
å¯¹ç§°åŠ å¯† ðŸ”‘
â”œâ”€ åŒæ–¹ä½¿ç”¨åŒä¸€æŠŠé’¥åŒ™
â”œâ”€ åŠ å¯†è§£å¯†å¿«ï¼ˆé€‚åˆå¤§æ•°æ®ï¼‰
â””â”€ é—®é¢˜ï¼šåˆå§‹é’¥åŒ™æ€Žä¹ˆå®‰å…¨ä¼ é€’ï¼Ÿ

éžå¯¹ç§°åŠ å¯† ðŸ”’ðŸ”‘
â”œâ”€ å…¬é’¥ï¼ˆpublic keyï¼‰- ä»»ä½•äººéƒ½èƒ½æœ‰ï¼Œç”¨æ¥åŠ å¯†
â”œâ”€ ç§é’¥ï¼ˆprivate keyï¼‰- åªæœ‰ä¸€ä¸ªäººæœ‰ï¼Œç”¨æ¥è§£å¯†
â”œâ”€ åŠ å¯†è§£å¯†æ…¢ï¼ˆé€‚åˆå°æ•°æ®ï¼‰
â””â”€ ä¼˜åŠ¿ï¼šä¸éœ€è¦æå‰å…±äº«å¯†é’¥
```

**SSL/TLSæ¡æ‰‹è¿‡ç¨‹ (TLS 1.2)ï¼š**
```
å®¢æˆ·ç«¯                              æœåŠ¡å™¨
  |                                  |
  |--- ClientHello (æ”¯æŒçš„ç®—æ³•) ----->|
  |                                  |
  |<--- ServerHello (é€‰æ‹©çš„ç®—æ³•) -----|
  |<--- Certificate (æœåŠ¡å™¨è¯ä¹¦) ----|
  |<--- ServerKeyExchange ------------|
  |<--- ServerHelloDone -------------|
  |                                  |
  |--- ClientKeyExchange ----------->|
  |--- ChangeCipherSpec ----------->|
  |--- Finished ------------------>|
  |                                  |
  |<--- ChangeCipherSpec ------------|
  |<--- Finished ------------------|
  |                                  |
  |===== åŠ å¯†é€šé“å»ºç«‹ =====|
  |--- Encrypted Data ----------->|
  |<--- Encrypted Data ---------|
  |                                  |
```

**è¯¦ç»†æ­¥éª¤ï¼š**
```
1. ClientHello
   â””â”€ å®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡å™¨ï¼šæˆ‘æ”¯æŒè¿™äº›åŠ å¯†ç®—æ³•å’ŒTLSç‰ˆæœ¬

2. ServerHello
   â””â”€ æœåŠ¡å™¨é€‰æ‹©ï¼šæˆ‘ä»¬ç”¨è¿™ä¸ªç®—æ³•å’Œç‰ˆæœ¬

3. Server Certificate
   â””â”€ æœåŠ¡å™¨å‘é€è‡ªå·±çš„è¯ä¹¦ï¼ˆåŒ…å«å…¬é’¥å’Œèº«ä»½ä¿¡æ¯ï¼‰
   â””â”€ è¯ä¹¦ç”±å—ä¿¡ä»»çš„CAç­¾åï¼Œä¿è¯èº«ä»½çœŸå®ž

4. ServerKeyExchange
   â””â”€ æœåŠ¡å™¨å‘é€é¢å¤–çš„å¯†é’¥äº¤æ¢å‚æ•°

5. ClientKeyExchange
   â””â”€ å®¢æˆ·ç«¯ç”Ÿæˆ"é¢„ä¸»å¯†é’¥"ï¼Œç”¨æœåŠ¡å™¨å…¬é’¥åŠ å¯†å¹¶å‘é€

6. åŒæ–¹è®¡ç®—"ä¼šè¯å¯†é’¥"
   â””â”€ ä½¿ç”¨ç›¸åŒçš„ç®—æ³•ï¼Œä»Ž"é¢„ä¸»å¯†é’¥"æŽ¨å¯¼å‡ºå¯¹ç§°å¯†é’¥
   â””â”€ çŽ°åœ¨åŒæ–¹æ‹¥æœ‰ç›¸åŒçš„å¯†é’¥

7. ChangeCipherSpec
   â””â”€ å‘Šè¯‰å¯¹æ–¹ï¼š"æˆ‘è¦å¼€å§‹ç”¨åŠ å¯†äº†"

8. Finished
   â””â”€ å‘é€åŠ å¯†çš„éªŒè¯ä¿¡æ¯ï¼Œç¡®ä¿æ¡æ‰‹æˆåŠŸ
   â””â”€ å¦‚æžœèƒ½æ­£ç¡®è§£å¯†ï¼Œè¯´æ˜Žå¯†é’¥æ˜¯å¯¹çš„

ä»Žæ­¤ä»¥åŽï¼Œæ‰€æœ‰æ•°æ®éƒ½ç”¨è¿™ä¸ª"ä¼šè¯å¯†é’¥"åŠ å¯†ä¼ è¾“
```

**å‰ç«¯ä¸­çš„ä½“çŽ°ï¼š**
```javascript
// çŽ°ä»£æµè§ˆå™¨è‡ªåŠ¨å¤„ç†HTTPSæ¡æ‰‹
// ä½ åªéœ€è¦ç¡®ä¿ä½¿ç”¨https://å¼€å¤´çš„URL

// æ£€æŸ¥HTTPSè¿žæŽ¥çŠ¶æ€
console.log(location.protocol) // "https:" or "http:"

// åœ¨HTTPSä¸‹å¯ä»¥ä½¿ç”¨æ›´å¤šå®‰å…¨ç‰¹æ€§
if (location.protocol === 'https:') {
  // å¯ä»¥ä½¿ç”¨Secure Cookies
  // å¯ä»¥ä½¿ç”¨WebCrypto API
  // å¯ä»¥ä½¿ç”¨Service Workers
}
```

---

### 3. æ•°å­—è¯ä¹¦
**è€ƒç‚¹ï¼š** è¯ä¹¦çš„ç»“æž„ã€CAã€è¯ä¹¦éªŒè¯æµç¨‹

**é€šä¿—è§£é‡Šï¼š**
è¯ä¹¦å°±åƒ"èº«ä»½è¯"ï¼š
- **ç”±CAï¼ˆè®¤è¯æœºæž„ï¼‰é¢å‘** - åƒæ”¿åºœéƒ¨é—¨é¢å‘èº«ä»½è¯
- **åŒ…å«å…¬é’¥** - åƒèº«ä»½è¯ä¸Šæœ‰ä½ çš„ç…§ç‰‡
- **ç­¾åä¿è¯èº«ä»½** - åƒèº«ä»½è¯æœ‰é˜²ä¼ªæ ‡è®°

**è¯ä¹¦ç»“æž„ï¼š**
```
è¯ä¹¦å†…å®¹ï¼š
â”œâ”€ ç‰ˆæœ¬å·
â”œâ”€ åºåˆ—å·ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
â”œâ”€ ç­¾åç®—æ³•ï¼ˆå¦‚SHA-256ï¼‰
â”œâ”€ é¢å‘è€…ï¼ˆCAä¿¡æ¯ï¼‰
â”œâ”€ æœ‰æ•ˆæœŸ
â”‚  â”œâ”€ ç”Ÿæ•ˆæ—¥æœŸ
â”‚  â””â”€ è¿‡æœŸæ—¥æœŸ
â”œâ”€ ä¸»ä½“ï¼ˆæœåŠ¡å™¨ä¿¡æ¯ï¼‰
â”‚  â”œâ”€ åŸŸåï¼ˆCNï¼‰
â”‚  â”œâ”€ ç»„ç»‡åï¼ˆOï¼‰
â”‚  â””â”€ å›½å®¶ï¼ˆCï¼‰
â”œâ”€ å…¬é’¥ï¼ˆRSA 2048æˆ–æ›´å¼ºï¼‰
â””â”€ CAç­¾åï¼ˆç”¨CAçš„ç§é’¥å¯¹ä¸Šè¿°å†…å®¹ç­¾åï¼‰
```

**è¯ä¹¦éªŒè¯æµç¨‹ï¼š**
```
å®¢æˆ·ç«¯æ”¶åˆ°è¯ä¹¦åŽï¼š
1. æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¿‡æœŸ
   â””â”€ æ¯”å¯¹ç³»ç»Ÿæ—¶é—´å’Œæœ‰æ•ˆæœŸ

2. æ£€æŸ¥è¯ä¹¦åŸŸåæ˜¯å¦åŒ¹é…
   â””â”€ è®¿é—®example.comï¼Œä½†è¯ä¹¦æ˜¯other.com â†’ é”™è¯¯ï¼

3. éªŒè¯è¯ä¹¦ç­¾å
   â””â”€ ç”¨CAçš„å…¬é’¥è§£å¯†ç­¾å
   â””â”€ æ¯”å¯¹è§£å¯†ç»“æžœå’Œè¯ä¹¦å†…å®¹
   â””â”€ ç›¸ç¬¦è¯´æ˜Žè¯ä¹¦çœŸå®žæœªè¢«ç¯¡æ”¹

4. éªŒè¯CAæ˜¯å¦å—ä¿¡ä»»
   â””â”€ æ£€æŸ¥æµè§ˆå™¨/ç³»ç»Ÿçš„ä¿¡ä»»CAåˆ—è¡¨
   â””â”€ å¦‚æžœCAä¸åœ¨åˆ—è¡¨ä¸­ â†’ è­¦å‘Šï¼

âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡ â†’ å»ºç«‹HTTPSè¿žæŽ¥
âŒ ä»»ä½•æ£€æŸ¥å¤±è´¥ â†’ æ‹’ç»è¿žæŽ¥æˆ–è­¦å‘Šç”¨æˆ·
```

**å¸¸è§è¯ä¹¦é—®é¢˜ï¼š**
```javascript
// 1. è¯ä¹¦è¿‡æœŸ
// æµè§ˆå™¨è­¦å‘Šï¼šæ‚¨çš„è¿žæŽ¥ä¸æ˜¯ç§å¯†è¿žæŽ¥
// åŽŸå› ï¼šè¯ä¹¦æœ‰æ•ˆæœŸå·²ç»“æŸ

// 2. åŸŸåä¸åŒ¹é…
// æµè§ˆå™¨è­¦å‘Šï¼šè¯ä¹¦æ— æ•ˆ
// åŽŸå› ï¼šè®¿é—®example.comä½†è¯ä¹¦æ˜¯other.com

// 3. è‡ªç­¾åè¯ä¹¦
// æµè§ˆå™¨è­¦å‘Šï¼šæ— æ³•éªŒè¯æ­¤ç½‘ç«™çš„èº«ä»½
// åŽŸå› ï¼šè¯ä¹¦ä¸æ˜¯ç”±å¯ä¿¡CAé¢å‘ï¼Œè€Œæ˜¯è‡ªå·±ç­¾å

// 4. æ··åˆå†…å®¹ï¼ˆMixed Contentï¼‰
// åœ¨HTTPSé¡µé¢åŠ è½½HTTPèµ„æº
// æµè§ˆå™¨è­¦å‘Šï¼šæ‚¨çš„è¿žæŽ¥ä¸æ˜¯å®Œå…¨ç§å¯†çš„
```

---

### 4. æ€§èƒ½è€ƒè™‘
**è€ƒç‚¹ï¼š** HTTPSçš„å¼€é”€ã€ä¼˜åŒ–ç­–ç•¥

**é€šä¿—è§£é‡Šï¼š**
HTTPSæ¯”HTTPå¤šäº†åŠ å¯†/è§£å¯†çš„è®¡ç®—ï¼Œä½†çŽ°ä»£ä¼˜åŒ–ä½¿è¿™ä¸ªå¼€é”€å¾ˆå°ã€‚

**æ€§èƒ½å¯¹æ¯”ï¼š**
```
HTTP (æ— åŠ å¯†)
â”œâ”€ å»ºç«‹è¿žæŽ¥ï¼š3-Way Handshake (~100ms)
â””â”€ ä¼ è¾“æ•°æ®ï¼šç›´æŽ¥ä¼ è¾“ï¼ˆæœ€å¿«ï¼‰

HTTPS (æœ‰åŠ å¯†)
â”œâ”€ å»ºç«‹è¿žæŽ¥ï¼š3-Way Handshake (~100ms)
â”œâ”€ TLSæ¡æ‰‹ï¼šé¢å¤–æ¡æ‰‹ (~100-300ms)
â”œâ”€ åŠ å¯†è®¡ç®—ï¼šCPUä½¿ç”¨çŽ‡å¢žåŠ ï¼ˆçŽ°ä»£CPUå¾ˆå¿«ï¼‰
â””â”€ ä¼ è¾“æ•°æ®ï¼šåŠ å¯†ä¼ è¾“ï¼ˆç•¥æ…¢ï¼Œä½†æ•´ä½“å½±å“<10%ï¼‰

çŽ°ä»£ä¼˜åŒ–
â”œâ”€ HTTP/2ï¼šå¤šè·¯å¤ç”¨ï¼Œå……åˆ†åˆ©ç”¨åŠ å¯†è¿žæŽ¥
â”œâ”€ ä¼šè¯å¤ç”¨ï¼šæ¢å¤æ—§ä¼šè¯ï¼Œè·³è¿‡å®Œæ•´æ¡æ‰‹
â””â”€ TLS 1.3ï¼šæ¡æ‰‹ç®€åŒ–ä¸º1å¾€è¿”ï¼ˆçŽ°ä»£æ ‡å‡†ï¼‰
```

**å‰ç«¯ä¼˜åŒ–å»ºè®®ï¼š**
```javascript
// 1. å¯ç”¨HTTPS/HTTP2
// åœ¨nginx/æœåŠ¡å™¨é…ç½®ä¸­å¯ç”¨

// 2. å¯ç”¨HSTSï¼ˆå¼ºåˆ¶HTTPSï¼‰
// å“åº”å¤´ï¼šStrict-Transport-Security: max-age=31536000

// 3. åˆç†ä½¿ç”¨Keep-Alive
fetch('/api/data1')
fetch('/api/data2')
// è‡ªåŠ¨å¤ç”¨TCPè¿žæŽ¥

// 4. å‡å°‘æ¡æ‰‹æ¬¡æ•°
// âœ… å‡å°‘è·¨åŸŸè¯·æ±‚æ•°
// âŒ ä¸è¦ç”¨å¤šä¸ªåŸŸåï¼ˆæ¯ä¸ªéƒ½è¦æ¡æ‰‹ï¼‰

// 5. ä½¿ç”¨CDN
// åœ°ç†ä½ç½®æ›´è¿‘ â†’ æ¡æ‰‹å»¶è¿Ÿæ›´ä½Ž
```

---

## HTTP å¸¸è§å®‰å…¨é—®é¢˜

### 1. ä¸­é—´äººæ”»å‡» (MITM)
```
æ²¡æœ‰HTTPSçš„æƒ…å†µï¼š
ç”¨æˆ· â†â†’ [æ”»å‡»è€…] â†â†’ æœåŠ¡å™¨
      æ‹¦æˆªä¿®æ”¹æ•°æ®

æœ‰HTTPSçš„æƒ…å†µï¼š
ç”¨æˆ· â†â†’ [æ”»å‡»è€…çœ‹ä¸æ‡‚] â†â†’ æœåŠ¡å™¨
      æ•°æ®è¢«åŠ å¯†
```

### 2. Cookie å®‰å…¨
```javascript
// å®‰å…¨çš„Cookieè®¾ç½®
Set-Cookie: sessionId=abc123;
            Secure;           // åªé€šè¿‡HTTPSä¼ è¾“
            HttpOnly;         // JSæ— æ³•è®¿é—®ï¼ˆé˜²XSSï¼‰
            SameSite=Strict;  // é˜²CSRF

// åœ¨JSä¸­è®¾ç½®ï¼ˆæœ‰é™åˆ¶ï¼‰
document.cookie = "name=value; Secure; SameSite=Strict"
// æ³¨æ„ï¼šHttpOnlyä¸èƒ½åœ¨JSä¸­è®¾ç½®ï¼Œåªèƒ½åœ¨æœåŠ¡å™¨è®¾ç½®
```

### 3. è¯·æ±‚å¤´æ³¨å…¥
```javascript
// âŒ å±é™©ï¼šç›´æŽ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥
const userInput = "value\r\nX-Custom: hacked"
fetch('/api', {
  headers: { 'X-Auth': userInput }
})

// âœ… æ­£ç¡®ï¼šæµè§ˆå™¨è‡ªåŠ¨éªŒè¯ï¼ˆFetch APIä¼šæ‹’ç»éžæ³•å¤´éƒ¨ï¼‰
// æŸäº›å¤´éƒ¨æ˜¯ç¦ç”¨çš„ï¼Œæ— æ³•è¢«JSè®¾ç½®
```

---

## å®žæˆ˜åœºæ™¯

### åœºæ™¯1ï¼šAPIè°ƒç”¨ä¸­çš„å®‰å…¨
```javascript
// âœ… æ­£ç¡®åšæ³•
const response = await fetch('https://api.example.com/user', {
  method: 'GET',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}` // å°†tokenæ”¾åœ¨Authorizationå¤´
  },
  credentials: 'include' // è‡ªåŠ¨å‘é€Cookieï¼ˆéœ€è¦Secure + HTTPSï¼‰
})

// âŒ é”™è¯¯åšæ³•
const response = await fetch(`https://api.example.com/user?token=${token}`)
// æŠŠå¯†æ„Ÿä¿¡æ¯æ”¾åœ¨URLä¸­ï¼Œä¼šè¢«è®°å½•åœ¨æ—¥å¿—/åŽ†å²ä¸­
```

### åœºæ™¯2ï¼šå¤„ç†è¯ä¹¦é”™è¯¯
```javascript
// åœ¨æŸäº›ç‰¹æ®Šåœºæ™¯ï¼ˆå¦‚å†…ç½‘å¼€å‘ï¼‰
// Node.jsä¸­å¯ä»¥è·³è¿‡è¯ä¹¦éªŒè¯ï¼ˆä¸æŽ¨èç”¨äºŽç”Ÿäº§ï¼‰
const https = require('https')
const fs = require('fs')

const agent = new https.Agent({
  rejectUnauthorized: false // âš ï¸ ä»…ç”¨äºŽå¼€å‘ï¼
})

fetch('https://self-signed.local', { agent })
```

---

## å¿«é€Ÿè‡ªæµ‹

- [ ] èƒ½è§£é‡ŠHTTPçš„ä¸‰å¤§é£Žé™©å—ï¼Ÿ
1.èƒ½çœ‹åˆ°è¯·æ±‚çš„å†…å®¹ï¼Œ2.å¯ä»¥éšæ„ç¯¡æ”¹è¯·æ±‚å†…å®¹ï¼Œ3.å¯ä»¥ä¼ªè£…æœåŠ¡å™¨ç»™ç”¨æˆ·å‘å†…å®¹
- [ ] HTTPå’ŒHTTPSçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
HTTPS = HTTP + SSL/TLS
èƒŒæ™¯ï¼šä¼ ç»Ÿ HTTP åè®®æœ‰å®‰å…¨é£Žé™©
1.èƒ½çœ‹åˆ°è¯·æ±‚çš„å†…å®¹ï¼Œ2.å¯ä»¥éšæ„ç¯¡æ”¹è¯·æ±‚å†…å®¹ï¼Œ3.å¯ä»¥ä¼ªè£…æœåŠ¡å™¨ç»™ç”¨æˆ·å‘å†…å®¹
æ­¤æ—¶éœ€è¦é’ˆå¯¹ HTTP åšåŠ å¯†ï¼ŒSSL/TLSå°±è¯žç”Ÿäº†
SSL å› ä¸ºæœ‰å®‰å…¨æ¼æ´žè¢«åºŸå¼ƒäº†
å½“ä»£ä¸»æµæµè§ˆå™¨éƒ½ä½¿ç”¨ TLS
TLS
æœ‰ä¸¤ç§åŠ å¯†æ¨¡å¼
å¯¹ç§°åŠ å¯†ï¼Œéžå¯¹ç§°åŠ å¯†
å¯¹ç§°åŠ å¯†é€‚åˆä¼ è¾“å¤§æ•°æ®
éžå¯¹ç§°åŠ å¯†é€‚åˆå°æ•°æ®ï¼Œå› ä¸ºåŠ å¯†è§£å¯†æ…¢

- [ ] TLSæ¡æ‰‹çš„ä¸»è¦æ­¥éª¤æœ‰å“ªäº›ï¼Ÿ
- [ ] ä»€ä¹ˆæ˜¯å¯¹ç§°åŠ å¯†å’Œéžå¯¹ç§°åŠ å¯†ï¼Ÿ
- [ ] æ•°å­—è¯ä¹¦çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ
- [ ] å¸¸è§çš„HTTPçŠ¶æ€ç æœ‰å“ªäº›ï¼Ÿ
- [ ] GETå’ŒPOSTæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
- [ ] HTTP/2ç›¸æ¯”HTTP/1.1çš„ä¼˜åŠ¿ï¼Ÿ
è¯·æ±‚å¤´åŽ‹ç¼©
å¤šè·¯å¤ç”¨
æ€§èƒ½æç¤º 30%
