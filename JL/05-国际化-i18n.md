# 国际化（i18n）：模块化合并与零侵入接入

## 背景与目标
- 多业务线、多页面需要统一的国际化方案；要求新模块接入简单、命名规范统一、缺失键有回退。

## 方案与实现
- 模块化合并策略
  - 基于 `require.context` 自动收集 `modules`，按模块配置选择合并策略（assign/merge），聚合成 `messages`。
  - 代码：`src/src/i18n/modulesConfig.ts`（模块扫描与策略），`src/src/i18n/index.ts`（构建 messages 与默认 locale）。
- 零侵入接入
  - 新增模块只需新增文件并导出文案，系统自动合并至命名空间/根层；默认语言为英文，缺失键回退默认语言，避免线上缺词。
- 与业务解耦
  - 组件仅引用 `$t('path.key')`，不感知语言包来源；多业务线并行改文案互不影响，减少冲突。

## 成果（口径）
- 新模块接入成本降到“分钟级”；跨页文案一致性提升；缺失键在线上不致崩溃（有回退）。

## 常见追问与回答建议
- Q：assign/merge 的边界？
  - A：assign 将模块作为命名空间整块挂载；merge 直接合并至根层，用于全局公共文案。按文件类型选择策略，避免 key 冲突。
- Q：如何保障不丢键？
  - A：默认英文 + 缺失回退；同时在评审中约束 key 命名规范，避免重复与覆盖。
- Q：为什么不使用动态加载语言包？
  - A：移动端 WebView 页面短、语言切换频率低，优先稳定与接入效率；如需再做懒加载可按页面拆分。

## 代码证据点
- 模块扫描与策略：`src/src/i18n/modulesConfig.ts`
- 消息聚合与默认语言：`src/src/i18n/index.ts`

